{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Set Checks{% endblock %}</h1> 
{% endblock %}

{% block content %}
    

<div class="container-fluid  mt-5 ">
    
    <div class="row">    

        {#                  #}
        {# LEFT HAND PANEL #}
        {#                  #}

        <div class="col-6 ">
            
            <div class="card" style="height: 60vh">
                <div class="card-body" style="font-size: 1em;">
                    The following checks will be run (selectability and nicer set-check titles etc TBI):

                    <table class="table table-bordered">
                        <thead>
                            <!-- add the row of column titles -->
                            <tr>
                                <th scope="col">Set Check</th>
                                <th scope="col">Run Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for setchk in setchks_session.selected_setchks %}
                                {% set sc=setchk.setchk_code %}
                                {% set setchk_run_status = setchks_session.setchks_run_status[sc] %}
                                <tr>
                                <td> {{ setchk.setchk_short_name }}</td>
                                <td> {{ setchk_run_status }} </td>
                                </tr>
                            {% endfor %}
                            <tr>
                                <td> Generate Excel Output</td>
                                <td> {{setchks_session.setchks_run_status["GENERATE_EXCEL"]}}</td>
                            </tr>
                        </tbody>
                    </table>



                       
                </div>
            </div>

        </div>

        {#                  #}
        {# RIGHT HAND PANEL #}
        {#                  #}

        <div class="col-6">


            <div class="card" style="height: 30vh">
                <div class="card-body" style="font-size: 1em;">
                    <ul>
                        <li> A summary of meta data will be here (TBI) </li>
                    </ul>
                </div>
            </div>

            <style>
            .setchks-btn-green {
                background-color: #007f3b;
                color: white;
                border-style: solid;
                border-width: 3px;
                border-color: black;
                }

                .setchks-btn-green:hover {
                background-color: #005f1b;
                color: white;
                border-style: solid;
                border-width: 3px;
                border-color: black;
                }
            </style>
            
            <div class="card" style="height: 29vh; margin-top:1vh;">
                <div class="card-body" style="font-size: 1em;">
                    <ul>
                        {% if setchks_session.setchks_jobs_manager.jobs_running %}
                            <a href="/select_and_run_checks" class="btn setchks-btn">Job(s) running - click to refresh run statuses</a>
                        <br>Please do not navigate away from this page while jobs are running (safeguards TBI)
                        {% elif not setchks_session.all_CHKXX_finished %}
                            <a href="/select_and_run_checks?run_checks=True"  class="btn setchks-btn">Run checks</a>
                        {% endif %}
                        {% if (not setchks_session.setchks_jobs_manager.jobs_running) and 
                            results_available and (not setchks_session.excel_file_available) %}
                            <a href="/select_and_run_checks?generate_report=True" class="btn setchks-btn-green">Generate Excel Report</a>
                        {% endif %}
                        {% if setchks_session.excel_file_available %}
                            <a href="/select_and_run_checks?download_report=True" class="btn setchks-btn-green">Download Excel Report</a>
                        {% endif %}

                    </ul>
                </div>
            </div>

        </div>
    </div>

    <div class="row" style="margin-top:1em">
    
        <style>
            .setchks-btn {
                background-color:white;
                color: black;
                border-style: solid;
                border-color:#005eb8;
                border-width :3px; 
                }
            .setchks-btn:hover {background-color:#ffeb3b; border-style: solid; border-color:#005eb8; border-width :3px;  }
            .setchks-btn-inactive {
                background-color: lightgray;
                color: lightslategray;
                border-style: solid;
                }
            
            
        </style>
         <div class="col-9"> 
            <a href="/reset_setchks_session"  class="btn setchks-btn">Hard reset</a>
            <a href="/data_upload"  class="btn setchks-btn">Data upload</a>
        </div>
        <div class="col-3">
            <a href="/enter_metadata"  class="btn setchks-btn"><i class="bi bi-arrow-left"></i> (Enter metadata)</a>
            <a href="/data_upload"  class="btn setchks-btn"><i class="bi bi-arrow-right"></i> Data upload</a>
        </div>
    
    </div>
</div>

  
{% endblock %}
